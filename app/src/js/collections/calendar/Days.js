// Generated by CoffeeScript 1.6.2
define(['ovivo'], function() {
  return Backbone.Collection.extend({
    comparator: function(day) {
      return day.dateObj();
    },
    initElements: function(elements, days) {
      var _this = this;

      return _.each(_.zip(elements, days), function(_arg) {
        var day, element;

        element = _arg[0], day = _arg[1];
        _this.add(day, {
          el: element
        });
        return _this;
      });
    },
    processEventAdd: function(event) {
      var _ref;

      return (_ref = this.get(event.getKey())) != null ? _ref.addEvent(event) : void 0;
    },
    _workingHourProcessor: function(rangeResult) {
      var _this = this;

      return _.each(rangeResult, function(obj) {
        var _key, _ref;

        _key = "" + (obj.date.getFullYear()) + "-" + (obj.date.getMonth()) + "-" + (obj.date.getDate());
        return (_ref = _this.get(_key)) != null ? _ref.addWorkingHour(obj.model) : void 0;
      });
    },
    processWorkingHours: function(start, end) {
      return this._workingHourProcessor(ovivo.desktop.resources.workingHours.processRange(start, end));
    },
    processWorkingHourAdd: function(workingHour) {
      var end, start;

      start = this.first().dateObj();
      end = this.last().dateObj();
      return this._workingHourProcessor(workingHour.processRange(start, end));
    },
    initialize: function(models, options) {
      _.extend(this, options);
      ovivo.desktop.resources.events.on('add', this.processEventAdd, this);
      ovivo.desktop.resources.workingHours.on('add', this.processWorkingHourAdd, this);
      return true;
    }
  });
});
